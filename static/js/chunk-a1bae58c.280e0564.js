(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a1bae58c","chunk-5241b4d2"],{"2fd0":function(t,e,a){},"333d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[a("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},n=[];a("c5f6");Math.easeInOutQuad=function(t,e,a,i){return t/=i/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var o=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function s(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(t,e,a){var i=l(),n=t-i,r=20,c=0;e="undefined"===typeof e?500:e;var u=function t(){c+=r;var l=Math.easeInOutQuad(c,i,n,e);s(l),c<e?o(t):a&&"function"===typeof a&&a()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit("update:limit",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,limit:t}),this.autoScroll&&r(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,limit:this.pageSize}),this.autoScroll&&r(0,800)}}},u=c,d=(a("dfcf"),a("2877")),g=Object(d["a"])(u,i,n,!1,null,"ef53c196",null);e["default"]=g.exports},"9fed":function(t,e,a){"use strict";var i=a("2fd0"),n=a.n(i);n.a},ac80:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{padding:"1rem"}},[a("div",[a("el-button",{attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:function(e){return t.addFun()}}},[t._v("添加")])],1),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-top":"1rem"},attrs:{size:"small",border:"",data:t.tableData3,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{label:"套餐编号",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.sid))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"gname",label:"积分名称",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"packageDetail",label:"商品名称",width:"250"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sname",label:"套餐名称",width:"250"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"120",label:"操作","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){return t.edit(e.row)}}}),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return t.del(e.row)}}})]}}])})],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getList}}),t._v(" "),a("div",[a("el-dialog",{attrs:{width:"45%","close-on-click-modal":!1,title:t.diaTitle,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e},close:function(e){return t.close()}}},[a("el-form",{ref:"packageEntity",attrs:{rules:t.rules,model:t.packageEntity}},[a("el-form-item",{attrs:{label:"积分名称",prop:"gid","label-width":t.formLabelWidth}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.packageEntity.gid,callback:function(e){t.$set(t.packageEntity,"gid",e)},expression:"packageEntity.gid"}},t._l(t.coreInfo,(function(t){return a("el-option",{key:t.value,attrs:{label:t.gname,value:t.gid}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{prop:"goodsNames",label:"商品名称","label-width":t.formLabelWidth}},[a("div",{staticClass:"colorText"},[t._v("（单个商品不超过5个）")]),t._v(" "),a("div",{staticStyle:{height:"300px","overflow-y":"auto"}},[a("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange},model:{value:t.packageEntity.goodsNames,callback:function(e){t.$set(t.packageEntity,"goodsNames",e)},expression:"packageEntity.goodsNames"}},[a("div",{staticClass:"checkTest"},t._l(t.goods,(function(e){return a("div",{key:e.id,staticClass:"cheDiv"},[a("div",[a("el-checkbox",{attrs:{label:e.cname},on:{change:function(a){return t.singleChange(a,e)}}},[t._v(t._s(e.cname))])],1),t._v(" "),a("div",[e.isShow?a("el-input-number",{staticStyle:{width:"5rem"},attrs:{size:"mini","controls-position":"right",min:1,max:5},on:{change:t.handleChange},model:{value:e.rCount,callback:function(a){t.$set(e,"rCount",a)},expression:"good.rCount"}}):t._e()],1)])})),0)])],1)]),t._v(" "),a("el-form-item",{attrs:{prop:"sname",label:"套餐名称","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.packageEntity.sname,callback:function(e){t.$set(t.packageEntity,"sname",e)},expression:"packageEntity.sname"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){return t.close()}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.confirm()}}},[t._v("确 定")])],1)],1)],1)],1)},n=[],o=(a("ac6a"),a("6b54"),a("333d")),s=a("d815"),l={components:{Pagination:o["default"]},data:function(){var t=function(t,e,a){void 0!==e?(e=e.toString().trim(),""===e?a(new Error("积分档不能为空")):a()):a(new Error("积分档不能为空"))},e=function(t,e,a){a()},a=function(t,e,a){void 0!==e?(e=e.toString().trim(),""===e?a(new Error("套餐不能为空")):a()):a(new Error("套餐不能为空"))};return{tableData3:[],coreInfo:[],packageEntity:{gid:"",gname:"",goodsNames:[],sname:""},goods:[],allGoodsInfo:[],total:0,listQuery:{page:1,limit:10,importance:void 0,title:void 0,type:void 0,sort:"+id"},diaTitle:"",multipleSelection:[],checkedAll:!1,dialogFormVisible:!1,formLabelWidth:"100px",rules:{gid:[{validator:t,trigger:"change"}],goodsNames:[{validator:e,trigger:"blur"}],sname:[{validator:a,trigger:"blur"}]},dialogImageUrl:"",dialogVisible:!1,ad_url_list:[],limitCount:1,hideUpload:!1}},mounted:function(){this.getList(),this.getAllCores(),this.getAllGoods()},methods:{getAllGoods:function(){var t=this;this.$axios.post(s["a"].packageInfo.getAllGoods).then((function(e){200===e.status&&(e.data.map((function(t){t.isShow=!1,t.rCount=""})),t.goods=e.data)}))},getAllCores:function(){var t=this;this.$axios.post(s["a"].packageInfo.getAllCores).then((function(e){200===e.status&&(t.coreInfo=e.data)}))},getList:function(){var t=this;this.$axios.post(s["a"].packageInfo.getList,{begin:this.listQuery.page,page:this.listQuery.limit}).then((function(e){if(200===e.status){t.total=e.data.total,e.data.rows.map((function(t){var e=t.strName.join(",");t.packageDetail=e})),t.tableData3=e.data.rows;var a=t.tableData3.length;0===a&&t.listQuery.page>1&&(t.listQuery.page-=1,t.getList())}else t.$message({type:"error",message:"查询失败"})}))},toggleSelection:function(t){var e=this;t?t.forEach((function(t){e.$refs.multipleTable.toggleRowSelection(t)})):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(t){t.length>0?this.checkedAll=!0:this.checkedAll=!1,this.multipleSelection=t},addFun:function(){this.diaTitle="新增套餐",this.dialogFormVisible=!0},delAll:function(){var t=this;this.$confirm("此操作将永久删除所有积分记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$message({type:"success",message:"删除成功!",duration:1e3})})).catch((function(){t.$message({type:"info",message:"已取消删除",duration:1e3})}))},edit:function(t){var e=this;this.diaTitle="修改套餐",this.packageEntity=t;var a=t.rName;this.packageEntity={sid:t.sid,gid:t.gid,gname:t.gname,sname:t.sname,goodsNames:a},this.dialogFormVisible=!0;var i=t.rId,n=t.rCount;i.map((function(t,a){e.goods.map((function(e){t===e.cid&&(e.isShow=!0,e.rCount=n[a])}))}))},del:function(t){var e=this;this.$confirm("此操作将永久删除该积分记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$axios.post(s["a"].packageInfo.delPackage,{sid:t.sid}).then((function(t){200===t.data.code?(e.$message({type:"success",message:t.data.msg,duration:1e3}),e.getList()):e.$message({type:"success",message:t.data.msg,duration:1e3})}))})).catch((function(){e.$message({type:"error",message:"已取消删除"})}))},close:function(){this.dialogFormVisible=!1,this.packageEntity={goodsNames:[]},this.resetForm("packageEntity"),this.getAllGoods()},handleCheckedCitiesChange:function(t){var e=this;this.packageEntity.goodsNames.map((function(t){e.goods.map((function(e){t===e.cname&&(e.isShow=!0)}))}))},singleChange:function(t,e){e.isShow=t},handleChange:function(t){},confirm:function(){var t=this;this.$refs["packageEntity"].validate((function(e){if(e)if("新增套餐"===t.diaTitle){var a={};a.sname=t.packageEntity.sname,a.gid=t.packageEntity.gid,a.sid=t.packageEntity.sid;var i=t.goods.filter((function(t){return""!==t.rCount&&0!==t.rCount&&!1!==t.isShow})),n=[];i.map((function(t){var e="";e=t.cid+"、"+t.rCount,n.push(e)}));var o=n.join(";");a.gather=o,t.$axios.post(s["a"].packageInfo.addPackage,a).then((function(e){console.log("-----------------",e),200===e.data.code?(t.$message({type:"success",message:e.data.msg,duration:1e3}),t.getList(),t.dialogFormVisible=!1):t.$message({type:"error",message:e.data.msg,duration:1e3})}))}else if("修改套餐"===t.diaTitle){var l={};l.sname=t.packageEntity.sname,l.gid=t.packageEntity.gid,l.sid=t.packageEntity.sid;var r=t.goods.filter((function(t){return""!==t.rCount&&0!==t.rCount&&!1!==t.isShow})),c=[];r.map((function(t){var e="";e=t.cid+"、"+t.rCount,c.push(e)}));var u=c.join(";");l.gather=u,t.$axios.post(s["a"].packageInfo.editPackage,l).then((function(e){200===e.data.code?(t.$message({type:"success",message:e.data.msg,duration:1e3}),t.getList(),t.dialogFormVisible=!1):t.$message({type:"error",message:e.data.msg,duration:1e3})}))}}))},resetForm:function(t){void 0!==this.$refs[t]&&this.$refs[t].resetFields()}}},r=l,c=(a("9fed"),a("2877")),u=Object(c["a"])(r,i,n,!1,null,"48ab0e7a",null);e["default"]=u.exports},cd86:function(t,e,a){},dfcf:function(t,e,a){"use strict";var i=a("cd86"),n=a.n(i);n.a}}]);